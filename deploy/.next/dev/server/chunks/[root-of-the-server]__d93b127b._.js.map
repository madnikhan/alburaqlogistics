{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/muhammadmadni/alburaqlogistics/app/api/create-checkout-session/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport Stripe from 'stripe';\n\nconst stripe = new Stripe(process.env.STRIPE_SECRET_KEY || '', {\n  apiVersion: '2025-11-17.clover',\n});\n\nexport async function POST(request: NextRequest) {\n  try {\n    // Check if Stripe is configured\n    if (!process.env.STRIPE_SECRET_KEY || process.env.STRIPE_SECRET_KEY === 'your_stripe_secret_key') {\n      return NextResponse.json(\n        { error: 'Stripe is not configured. Please add your Stripe secret key to environment variables.' },\n        { status: 500 }\n      );\n    }\n\n    const { bookingId, amount, customerEmail } = await request.json();\n\n    if (!bookingId || !amount || !customerEmail) {\n      return NextResponse.json(\n        { error: 'Missing required parameters' },\n        { status: 400 }\n      );\n    }\n\n    const session = await stripe.checkout.sessions.create({\n      payment_method_types: ['card'],\n      line_items: [\n        {\n          price_data: {\n            currency: 'gbp',\n            product_data: {\n              name: 'Al Buraq Logistics Service',\n              description: `Booking ID: ${bookingId}`,\n            },\n            unit_amount: amount,\n          },\n          quantity: 1,\n        },\n      ],\n      mode: 'payment',\n      success_url: `${process.env.NEXT_PUBLIC_BASE_URL || 'http://localhost:3000'}/booking-success?session_id={CHECKOUT_SESSION_ID}&booking_id=${bookingId}`,\n      cancel_url: `${process.env.NEXT_PUBLIC_BASE_URL || 'http://localhost:3000'}/book?canceled=true`,\n      customer_email: customerEmail,\n      metadata: {\n        bookingId: bookingId,\n      },\n    });\n\n    return NextResponse.json({ id: session.id });\n  } catch (error: any) {\n    console.error('Error creating checkout session:', error);\n    return NextResponse.json(\n      { error: error.message || 'Failed to create checkout session' },\n      { status: 500 }\n    );\n  }\n}\n\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,SAAS,IAAI,mKAAM,CAAC,QAAQ,GAAG,CAAC,iBAAiB,IAAI,IAAI;IAC7D,YAAY;AACd;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,gCAAgC;QAChC,IAAI,CAAC,QAAQ,GAAG,CAAC,iBAAiB,IAAI,QAAQ,GAAG,CAAC,iBAAiB,KAAK,0BAA0B;YAChG,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAwF,GACjG;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,EAAE,SAAS,EAAE,MAAM,EAAE,aAAa,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE/D,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,eAAe;YAC3C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA8B,GACvC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,UAAU,MAAM,OAAO,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC;YACpD,sBAAsB;gBAAC;aAAO;YAC9B,YAAY;gBACV;oBACE,YAAY;wBACV,UAAU;wBACV,cAAc;4BACZ,MAAM;4BACN,aAAa,CAAC,YAAY,EAAE,WAAW;wBACzC;wBACA,aAAa;oBACf;oBACA,UAAU;gBACZ;aACD;YACD,MAAM;YACN,aAAa,GAAG,6DAAoC,wBAAwB,6DAA6D,EAAE,WAAW;YACtJ,YAAY,GAAG,6DAAoC,wBAAwB,mBAAmB,CAAC;YAC/F,gBAAgB;YAChB,UAAU;gBACR,WAAW;YACb;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI,QAAQ,EAAE;QAAC;IAC5C,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,oCAAoC;QAClD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,MAAM,OAAO,IAAI;QAAoC,GAC9D;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}